import { BASE_PATH } from "@/lib/constants";
import { CommentIcon, LikeIcon, LogoIcon, ShareIcon, SmartMoneyIcon, TrendingIcon, TwitterIcon, TwitterVIcon, ViewIcon } from "@/lib/icons";
import classNames from "classnames";
import React, { useState } from "react";

const DATA_TYPE_LIST = [{
  key: 'smartmoney',
  name: 'Smart Money',
  icon: <SmartMoneyIcon/>
}, {
  key: 'twitter',
  name: 'X(Twitter)',
  icon: <TwitterIcon/>
}]

export default function SideContent() {

  const [dataType, setDataType] = useState<string>('smartmoney')

  return (
    <aside className="flex flex-none flex-col gap-[16px] w-[452px] rounded-[20px] shadow-md">
      <div className="flex flex-col gap-[8px] bg-[#C8FF00] rounded-[20px] px-[16px] py-[12px]">
        <h4 className="text-[20px] font-semibold">AI Summary</h4>
        <p className="text-[16px]">
          {`$PAOFU, representing Xiaohongshu's viral cat 'Wang Paofu', with 5 million followers, now a token. No detailed project features or roadmap provided.`}
        </p>
        <div className="flex flex-row rounded-[6px] bg-[#EEFFB0] items-center">
          <div className="flex flex-row px-[16px] py-[8px] items-center gap-[4px]">
            <div className="flex w-[16px] h-[16px] rounded-full bg-black items-center justify-center"><LogoIcon/></div>
            <div className="text-[16px] font-semibold">PeerX</div>
          </div>
          <div className="text-[12px]">Auto generated by PeerX, DYOR.</div>
        </div>
      </div>

      <div className="flex flex-col gap-[8px] rounded-[20px] px-[16px] py-[12px]">
        <div className="flex flex-row gap-[16px]">
          {DATA_TYPE_LIST?.map(item=>{
            return <div className="relative inline-block group" key={item?.key} >
                <TabSetItem name="data-type-tab" value={item?.key} icon={<div className="h-[36px] flex items-center">{item?.icon}</div>} defaultChecked={dataType===item?.key} onChange={()=>{
                setDataType(item?.key)
              }}/>
              {/* tooltip */}
              <div className="whitespace-nowrap absolute left-1/2 transform -translate-x-1/2 bottom-full mb-2 hidden group-hover:block bg-black text-white text-[14px] px-2 py-1 rounded-[6px]">
                {item?.name}
                <div className="absolute bottom-[-4px] left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-t-black border-l-transparent border-r-transparent"></div>
              </div>
            </div>
          })}
        </div>
        {dataType==='smartmoney' && <SmartMoneyContent tokenAddress={''}/>}
        {dataType==='twitter' && <TwitterListContent />}
      </div>
    </aside>
  );
}

function TabSetItem({ value, name, icon, defaultChecked = false, onChange }: { value: string, name: string, icon?: React.JSX.Element, defaultChecked?: boolean, onChange?: React.ChangeEventHandler<HTMLInputElement>}) {
  return <label className="cursor-pointer flex justify-stretch items-center">
    <input type="radio" className='peer hidden' name={name} value={value} defaultChecked={defaultChecked} onChange={onChange}/>
    <div className={
      classNames(
        'bg-[#F9F9F9] rounded-[6px] px-[20px] py-[4px]',
        'peer-checked:text-[#000000] peer-checked:bg-[#C8FF00]',
        "hover:bg-white hover:text-[#000000]"
      )
    }>
      {icon}
    </div>
  </label>
}

function SmartMoneyContent({  }: { tokenAddress: string }) {

  return <div className="w-full flex flex-col">
    <SmartMoneyItem/>
    <SmartMoneyItem/>
    <SmartMoneyItem/>
    <SmartMoneyItem/>
    <SmartMoneyItem/>
    <SmartMoneyItem/>
    <SmartMoneyItem/>
    <div className="w-full h-[48px] text-[16px] font-bold rounded-[6px] text-black bg-[#C8FF00] flex items-center justify-center mt-[4px]">Learn more</div>
  </div>
}

function SmartMoneyItem() {
  return <div className="flex flex-col gap-[10px] py-[10px] border-b-[1px] border-[#F3F3F3]">
    <div className="flex flex-row gap-[4px] items-center">
      <img src={BASE_PATH + "/image/solana.png"} alt="" width={24} height={24} className="rounded-full"/>
      <div className="text-[24px]"><img src={BASE_PATH + "/image/green.png"} alt="" width={24} height={24}/></div>
      <div className="text-[16px] font-semibold text-[#049046]">Dq7js...ump</div>
      <div className="text-[16px] font-semibold text-[#666666]">(Dq7)</div>
    </div>
    <div className="flex flex-row gap-[4px] items-center justify-between text-[14px] font-semibold ">
      <div className="text-[#666666]">Bought <span className="text-black font-medium">449,348</span> for <span className="text-black font-medium">14.64</span> SOL ($2,692.9)</div>
      <div className="text-[#999]">1m ago</div>
    </div>
  </div>
}

function TwitterListContent() {
  return <div className="w-full flex flex-col gap-[16px]">
    <div className="flex flex-row items-center gap-[16px]">
      <TabSetItem name="twitter-sort-tab" value="top" icon={<div className="text-[16px] font-bold text-black">TOP</div>} defaultChecked/>
      <TabSetItem name="twitter-sort-tab" value="latest" icon={<div className="text-[16px] font-bold text-[#666]">Latest</div>}/>
      <TabSetItem name="twitter-sort-tab" value="follower" icon={<div className="text-[16px] font-bold text-[#666]">Follower</div>}/>
      <TabSetItem name="twitter-sort-tab" value="official" icon={<div className="text-[16px] font-bold text-[#666]">Official</div>}/>
    </div>
    <div className="flex flex-col gap-[16px]">
      <TwitterItem/>
      <TwitterItem/>
      <TwitterItem/>
    </div>
  </div>
}

function TwitterItem() {
  return <div className="flex flex-col gap-[10px] rounded-[6px] p-[20px] bg-[#F9F9F9]">
    <div className="flex flex-row items-center justify-between">
      <div className="flex flex-row gap-[8px] items-center">
        <div className="w-[16px] h-[16px] rounded-full bg-black flex items-center justify-center"><LogoIcon/></div>
        <div className="text-[16px] font-bold">PeerX</div>
      </div>
      <div><TwitterIcon/></div>
    </div>
    <div className="flex flex-row items-center gap-[10px]">
      <div className="w-[48px] h-[48px] rounded-full bg-black"></div>
      <div className="flex flex-col">
        <div className="flex flex-row items-center text-[16px] font-bold text-black gap-[6px]">Minch<span><TwitterVIcon/></span></div>
        <div className="text-[12px] text-[#666]">@minchTHEfinch · Followers: 2327 · 17min ago</div>
      </div>
    </div>
    <div className="text-[16px] text-black pb-[6px]">chart is honestly looking really good, if we can surpass ATH and break out, well see that $1M Im going tokeep bull posting this until we see it happen. $PAOFU5o9knHKztdtms ovyDQymEYF8CfgL6wV6hgt2zrhpump</div>
    <div className="grid grid-cols-2 gap-[8px] pb-[6px]">
      <img src="https://pbs.twimg.com/media/GdAF7inWsAQ7Coq?format=png&name=900x900" alt="" className="rounded-[10px]"/>
      <img src="https://pbs.twimg.com/media/GdAF7inWsAQ7Coq?format=png&name=900x900" alt="" className="rounded-[10px]"/>
    </div>
    <div className="flex flex-row items-center gap-[16px]">
      <TwitterActionItem icon={<CommentIcon/>} value={'45'}/>
      <TwitterActionItem icon={<ShareIcon/>} value={'68'}/>
      <TwitterActionItem icon={<LikeIcon/>} value={'108'}/>
      <TwitterActionItem icon={<ViewIcon/>} value={'2.1k'}/>
      <TwitterActionItem icon={<TrendingIcon/>} value={'45'}/>
    </div>
  </div>
}

function TwitterActionItem({value, icon} : {value: string, icon: React.JSX.Element}) {
  return <div className="flex flex-1 flex-row items-center gap-[4px]">
    <div>{icon}</div>
    <div className="text-[14px]">{value}</div>
  </div>
}